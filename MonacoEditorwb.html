<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Code Editor</title>
    <link rel="icon" href="LogoSite.png">
    <link rel="stylesheet" href="https://unpkg.com/monaco-editor/min/vs/editor/editor.main.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        #editor {
            flex-grow: 1;
            border: 1px solid #ccc;
        }

        #toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background-color: #2e3b4e;
            color: white;
        }

        #toolbar button {
            background-color: #4CAF50;
            border: none;
            padding: 10px;
            color: white;
            cursor: pointer;
            border-radius: 5px;
            font-size: 14px;
        }

        #toolbar button:hover {
            background-color: #45a049;
        }

        #main-container {
            display: flex;
            height: 90vh;
        }

        #preview {
            flex-grow: 1;
            border-left: 1px solid #ccc;
            display: none;
            padding: 10px;
            background-color: #f4f4f4;
        }

        .resizable {
            resize: horizontal;
            overflow: auto;
        }

        #file-explorer {
            width: 200px;
            background-color: #1e293b;
            color: white;
            padding: 10px;
        }

        #file-explorer ul {
            list-style: none;
            padding: 0;
        }

        #file-explorer li {
            padding: 5px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
        }

        #file-explorer li:hover {
            background-color: #4CAF50;
        }

        #language-selector {
            margin-right: 10px;
        }

        .hidden {
            display: none;
        }

        #preview-container {
            display: flex;
            flex-direction: column;
            border-left: 1px solid #ccc;
        }

        #preview-header {
            background-color: #f4f4f4;
            padding: 5px;
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <div id="toolbar">
        <div>
            <select id="language-selector" onchange="changeLanguage(this.value)">
                <option value="javascript">JavaScript</option>
                <option value="python">Python</option>
                <option value="html">HTML</option>
                <option value="css">CSS</option>
                <option value="c">C</option>
                <option value="cpp">C++</option>
                <option value="java">Java</option>
                <option value="php">PHP</option>
                <option value="ruby">Ruby</option>
                <option value="go">Go</option>
                <option value="swift">Swift</option>
            </select>
            <button onclick="openFile()">Open File</button>
            <button onclick="togglePreview()">Preview Code</button>
        </div>
        <div>
            <button onclick="saveFile()">Save</button>
        </div>
    </div>

    <div id="main-container">
        <div id="file-explorer" class="resizable">
            <h3>Files</h3>
            <ul id="file-list">
                <li onclick="createFile()">+ New File</li>
            </ul>
        </div>

        <div id="editor"></div>
        <div id="preview-container" class="hidden">
            <div id="preview-header">
                <span>Live Preview</span>
                <button onclick="togglePreview()">Close</button>
            </div>
            <iframe id="preview" sandbox="allow-scripts allow-same-origin"></iframe>
        </div>
    </div>

    <script src="https://unpkg.com/monaco-editor/min/vs/loader.js"></script>
    <script>
        let editor;
        let previewVisible = false;
        let currentLanguage = 'javascript';

        // Configure Monaco Editor
        require.config({ paths: { 'vs': 'https://unpkg.com/monaco-editor/min/vs' } });

        require(['vs/editor/editor.main'], function () {
            editor = monaco.editor.create(document.getElementById('editor'), {
                value: '// Write your code here\n',
                language: currentLanguage,
                theme: 'vs-dark',
            });
        });

        // Change the language of the editor based on selection
        function changeLanguage(language) {
            currentLanguage = language;
            monaco.editor.setModelLanguage(editor.getModel(), language);
        }

        // Detect file language based on extension
        function detectLanguage(fileName) {
            const extension = fileName.split('.').pop();
            const languageMap = {
                js: 'javascript',
                py: 'python',
                html: 'html',
                css: 'css',
                c: 'c',
                cpp: 'cpp',
                java: 'java',
                php: 'php',
                rb: 'ruby',
                go: 'go',
                swift: 'swift'
            };
            return languageMap[extension] || 'plaintext';
        }

        // Toggle the visibility of the preview pane
        function togglePreview() {
            const previewContainer = document.getElementById('preview-container');
            previewVisible = !previewVisible;
            if (previewVisible) {
                previewContainer.classList.remove('hidden');
                updatePreview();
            } else {
                previewContainer.classList.add('hidden');
            }
        }

        // Update the preview pane with the current code
        function updatePreview() {
            const preview = document.getElementById('preview');
            if (currentLanguage === 'html') {
                preview.srcdoc = editor.getValue();
            } else {
                preview.srcdoc = `<pre>${editor.getValue()}</pre>`;
            }
        }

        // Save the current file to the user's device
        function saveFile() {
            const code = editor.getValue();
            const fileExtension = {
                javascript: 'js',
                python: 'py',
                html: 'html',
                css: 'css',
                c: 'c',
                cpp: 'cpp',
                java: 'java',
                php: 'php',
                ruby: 'rb',
                go: 'go',
                swift: 'swift'
            }[currentLanguage] || 'txt';

            const blob = new Blob([code], { type: `text/${currentLanguage}` });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `code.${fileExtension}`;
            link.click();
        }

        // Create a new file
        function createFile() {
            const fileName = prompt('Enter file name (with extension):');
            if (fileName) {
                const fileList = document.getElementById('file-list');
                const listItem = document.createElement('li');
                listItem.textContent = fileName;
                listItem.onclick = () => loadFile(fileName);
                listItem.oncontextmenu = (e) => {
                    e.preventDefault();
                    showFileOptions(e, listItem, fileName);
                };
                fileList.appendChild(listItem);
            }
        }

        // Load a file (placeholder logic)
        function loadFile(fileName) {
            const language = detectLanguage(fileName);
            changeLanguage(language);
            editor.setValue(`// Editing ${fileName}\n`);
        }

        // Show file options on right-click
        function showFileOptions(event, listItem, fileName) {
            const optionsMenu = document.createElement('div');
            optionsMenu.style.position = 'absolute';
            optionsMenu.style.left = `${event.pageX}px`;
            optionsMenu.style.top = `${event.pageY}px`;
            optionsMenu.style.background = '#fff';
            optionsMenu.style.border =
